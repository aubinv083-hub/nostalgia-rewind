<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Game Tester</title>
</head>
<body>
  <div class="game-wrap">

    <div class="game-panel">
      <canvas id="gameCanvas" width="900" height="520"></canvas>
      <div class="game-hint">Move: WASD/ZQSD • Shoot: Space • Start: Enter</div>
    </div>
  </div>

  <style>

     .game-wrap {
      --glow-bg: #5b2b82;
      --panel-bg: rgba(0,0,0,0.25);
      --panel-border: rgba(255,255,255,0.18);
      --text-main: #ffffff;
      --text-sub: rgba(255,255,255,0.85);
      max-width: 1000px;
      margin: 0 auto;
      padding: 12px;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    .game-title {
      margin: 0 0 12px;
      color: var(--text-main);
      font-size: 28px;
      letter-spacing: 0.4px;
    }

    .game-panel {
      background: var(--panel-bg);
      border: 4px solid rgba(183, 148, 244, 0.6);
      border-radius: 16px;
      padding: 16px;
      box-shadow:
        0 10px 30px rgba(0,0,0,0.25),
        0 0 24px rgba(91,43,130,0.6);
      backdrop-filter: blur(2px);
    }

    #gameCanvas {
      width: 100%;
      display: block;
      background: url("https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExd2NsbW5ncHQyZTE5aWQ0bGdzcjdkMmN6bG1xZ3Mxc3ZyNXo2cDFhcSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/TxVVB6PfWMjE4/giphy.gif") center/cover;
      border: 1px solid var(--panel-border);
      border-radius: 12px;
      box-shadow: inset 0 0 24px rgba(91,43,130,0.35);
    }

    .game-hint {
      margin-top: 10px;
      color: var(--text-sub);
      font-size: 14px;
    }
  </style>

  <script>
    
    setTimeout(function() {
      const canvas = document.getElementById("gameCanvas");
      
      if (!canvas) {
        console.error("Canvas not found!");
        return;
      }
      
      const ctx = canvas.getContext("2d");
      
      if (!ctx) {
        console.error("Could not get 2D context!");
        return;
      }

      console.log("Game initialized successfully!");

      const enemyImg = new Image();
      enemyImg.src = "https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExMzJrbHM1a3Bja3d4MHA0a3VhNjh3bnVvNTRiMTB6bTU1MHZ6Z2wyaiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/ZsMURfh9PLGydkBTnQ/giphy.gif";
      const playerImg = new Image();
      playerImg.src = "https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExOGM2ZTg5amVxZW1qNzIyZTdxZjM3Z2U2YTdlb2Roa25xNXk5YnVkYyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/X4PBIkA7R2nKzhLVxI/giphy.gif";

      // game state
      let running = false;
      let started = false;
      let score = 0;
      let timeAlive = 0;
      let lastTime = 0;

      // player
      const player = {
        x: 60,
        y: canvas.height / 2,
        size: 120,
        speed: 240,
        vx: 0,
        vy: 0,
      };

      // bullets
      const bullets = [];
      const bulletSpeed = 420;
      const bulletSize = 6;
      const fireCooldown = 180;
      let lastShot = 0;

      // enemies
      const enemies = [];
      let spawnTimer = 0;
      let spawnInterval = 1200;
      let enemySpeed = 140;

      // input
      const keys = new Set();
      document.addEventListener("keydown", (e) => {
        keys.add(e.code);
        if (e.code === "Space") e.preventDefault();
      });
      document.addEventListener("keyup", (e) => keys.delete(e.code));

      function reset() {
        running = true;
        score = 0;
        timeAlive = 0;
        lastTime = 0;
        bullets.length = 0;
        enemies.length = 0;
        spawnTimer = 0;
        spawnInterval = 1200;
        enemySpeed = 140;
        player.x = 60;
        player.y = canvas.height / 2;
      }

      function startGame() {
        started = true;
        reset();
      }

      function spawnEnemy() {
        const size = 34 + Math.random() * 22;
        const y = 20 + Math.random() * (canvas.height - 40);
        enemies.push({
          x: canvas.width + size,
          y,
          size,
          speed: enemySpeed + Math.random() * 40,
        });
      }

      function shoot(now) {
        if (now - lastShot < fireCooldown) return;
        lastShot = now;
        bullets.push({
          x: player.x + player.size,
          y: player.y + player.size / 2 - bulletSize / 2,
          size: bulletSize,
        });
      }

      function update(dt, now) {
        // movement
        player.vx = 0;
        player.vy = 0;
        if (keys.has("ArrowUp") || keys.has("KeyW")) player.vy = -player.speed;
        if (keys.has("ArrowDown") || keys.has("KeyS")) player.vy = player.speed;
        if (keys.has("ArrowLeft") || keys.has("KeyA")) player.vx = -player.speed;
        if (keys.has("ArrowRight") || keys.has("KeyD")) player.vx = player.speed;
        if (keys.has("Space")) shoot(now);

        player.x += player.vx * dt;
        player.y += player.vy * dt;

        // clamp
        player.x = Math.max(0, Math.min(canvas.width - player.size, player.x));
        player.y = Math.max(0, Math.min(canvas.height - player.size, player.y));

        // bullets
        for (let i = bullets.length - 1; i >= 0; i--) {
          bullets[i].x += bulletSpeed * dt;
          if (bullets[i].x > canvas.width + 20) bullets.splice(i, 1);
        }

        // enemies
        for (let i = enemies.length - 1; i >= 0; i--) {
          enemies[i].x -= enemies[i].speed * dt;
          if (enemies[i].x < -enemies[i].size) enemies.splice(i, 1);
        }

        // collisions
        for (let i = enemies.length - 1; i >= 0; i--) {
          const e = enemies[i];
          for (let j = bullets.length - 1; j >= 0; j--) {
            const b = bullets[j];
            if (
              b.x < e.x + e.size &&
              b.x + b.size > e.x &&
              b.y < e.y + e.size &&
              b.y + b.size > e.y
            ) {
              enemies.splice(i, 1);
              bullets.splice(j, 1);
              score += 1;
              break;
            }
          }
        }

        // collisions
        for (const e of enemies) {
          const playerHitSize = player.size * 0.45;
          const enemyHitSize = e.size * 0.45;
          const playerHitX = player.x + (player.size - playerHitSize) / 2;
          const playerHitY = player.y + (player.size - playerHitSize) / 2;
          const enemyHitX = e.x + (e.size - enemyHitSize) / 2;
          const enemyHitY = e.y + (e.size - enemyHitSize) / 2;

          if (
            playerHitX < enemyHitX + enemyHitSize &&
            playerHitX + playerHitSize > enemyHitX &&
            playerHitY < enemyHitY + enemyHitSize &&
            playerHitY + playerHitSize > enemyHitY
          ) {
            running = false;
            return;
          }
        }

        // difficulty scaling
        timeAlive += dt;
        spawnTimer += dt * 1000;
        const targetInterval = Math.max(350, 1200 - timeAlive * 30);
        spawnInterval = targetInterval;
        enemySpeed = 140 + timeAlive * 6;

        if (spawnTimer >= spawnInterval) {
          spawnTimer = 0;
          spawnEnemy();
        }
      }

      function draw() {
        // background
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // player
        if (playerImg.complete && playerImg.naturalWidth) {
          ctx.drawImage(playerImg, player.x, player.y, player.size, player.size);
        } else {
          ctx.fillStyle = "#ffffff";
          ctx.fillRect(player.x, player.y, player.size, player.size);
        }

        // bullets
        ctx.fillStyle = "#8bf0ff";
        for (const b of bullets) {
          ctx.fillRect(b.x, b.y, b.size, b.size);
        }

        // enemies 
        for (const e of enemies) {
          if (enemyImg.complete && enemyImg.naturalWidth) {
            ctx.drawImage(enemyImg, e.x, e.y, e.size, e.size);
          } else {
            ctx.fillStyle = "#ff6b6b";
            ctx.beginPath();
            ctx.moveTo(e.x, e.y + e.size / 2);
            ctx.lineTo(e.x + e.size, e.y);
            ctx.lineTo(e.x + e.size, e.y + e.size);
            ctx.closePath();
            ctx.fill();
          }
        }

        // HUD
        ctx.fillStyle = "#e6e6e6";
        ctx.font = "16px ui-monospace, monospace";
        ctx.fillText(`Score: ${score}`, 16, 24);

        if (!running) {
          ctx.fillStyle = "rgba(0,0,0,0.6)";
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          ctx.fillStyle = "#ffffff";
          ctx.font = "28px ui-monospace, monospace";
          if (!started) {
            ctx.fillText("TUX IN SPACE", canvas.width / 2 - 110, canvas.height / 2 - 30);
            ctx.font = "16px ui-monospace, monospace";
            ctx.fillText("Press ENTER to start", canvas.width / 2 - 110, canvas.height / 2 + 50);
          } else {
            ctx.fillText("GAME OVER", canvas.width / 2 - 90, canvas.height / 2 - 10);
            ctx.font = "16px ui-monospace, monospace";
            ctx.fillText("Press R to restart", canvas.width / 2 - 80, canvas.height / 2 + 18);
          }
        }
      }

      function loop(ts) {
        if (!lastTime) lastTime = ts;
        const dt = Math.min(0.033, (ts - lastTime) / 1000);
        lastTime = ts;

        if (running) update(dt, ts);
        draw();

        requestAnimationFrame(loop);
      }

      document.addEventListener("keydown", (e) => {
        if (!started && e.code === "Enter") startGame();
        if (started && !running && e.code === "KeyR") reset();
      });

      draw();
      requestAnimationFrame(loop);
    }, 100);
  </script>
</body>
</html>
